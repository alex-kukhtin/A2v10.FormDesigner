!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t={Grid:["Rows","Columns","Height"],TextBox:["Data","Label","Width","row","col","rowSpan","colSpan"],DatePicker:["Data","Label","Width","row","col","rowSpan","colSpan"],Selector:["Data","Label","Width","row","col","rowSpan","colSpan"],DataGrid:["Data","Height","row","col"],CLabel:["Label","row","col"],DataGridColumn:["Data","Label"],Toolbar:["row","col"],Pager:["row","col","Data"],Dialog:["Label","Width","Height","Data"],Page:["Label","Data"],Button:["Label","Command","Parameter"]};var e={template:'\n<div class="fd-taskpad">\n\t<ul class="fd-tabbar">\n\t\t<li :class="{active: activeTab === \'tbox\'}" @click.stop.prevent="activeTab = \'tbox\'">Toolbox</li>\n\t\t<li :class="{active: activeTab === \'props\'}" @click.stop.prevent="activeTab = \'props\'">Properties</li>\n\t</ul>\n\t<toolbox v-if="activeTab === \'tbox\'" :fields=fields :cont=cont :components=components />\n\t<propsheet v-if="activeTab === \'props\'" :item=item  />\n</div>\n',props:{item:Object,fields:Array,components:Array,cont:Object},components:{toolbox:{template:'\n<div class="fd-toolbox">\n\t<details open>\n\t\t<summary>Form Controls</summary>\n\t\t<ul>\n\t\t\t<toolboxitem v-for="(f, ix) in components" :key=ix :item=f :label=f.Is :cont=cont />\n\t\t</ul>\n\t</details>\n\t<details open>\n\t\t<summary>Data</summary>\n\t\t<ul>\n\t\t\t<toolboxitem v-for="(f, ix) in fields" :key=ix :item=f :label=f.Data :cont=cont />\n\t\t</ul>\n\t</details>\n</div>\n',components:{toolboxitem:{template:'\n<li class="fd-tbox-item" :draggable="true" @dragstart.stop=dragStart>\n\t<i class="ico ico-grid" />\n\t<span v-text=label />\n</li>\n',props:{icon:String,label:String,item:Object,cont:Object},methods:{dragStart(t){console.dir(this.cont),this.cont.select(this.item),t.dataTransfer.effectAllowed="move"}}}},props:{fields:Array,components:Array,cont:Object},computed:{},methods:{}},propsheet:{template:'\n<div class="fd-propsheet">\n\t{{item.Is}}\n\t<table>\n\t\t<tr v-for="(p, ix) in itemProps" :key=ix>\n\t\t\t<td v-text="p.name" />\n\t\t\t<td>\n\t\t\t\t<input v-model.lazy.trim="p.value" />\n\t\t\t</td>\n\t\t</tr>\t\n\t</table>\n</div>\n',props:{item:Object},computed:{itemProps(){if(!this.item)return[];const e=this.item.Is,s=t[e];return s?s.map((t=>{const e=this.item;return{name:t,get value(){return e[t]},set value(s){Vue.set(e,t,s)}}})):[]}},methods:{}}},data:()=>({activeTab:"tbox"}),computed:{props(){return this.item?this.item.Props:[]}},methods:{}};var s={template:'\n<div class="toolbar fd-toolbar">\n\t<button class="btn btn-tb btn-icon">\n\t\t<i class="ico ico-save-outline" />\n\t</button>\n\t<button class="btn btn-tb btn-icon">\n\t\t<i class="ico ico-clear" />\n\t</button>\n\t<div class="divider" />\n\t<button class="btn btn-tb btn-icon">\n\t\t<i class="ico ico-reload" />\n\t</button> \n</div>\n',props:{form:Object}};var n={template:'\n<div class="fd-grid-ph" :style="style"\n\t@drop=drop @dragover=dragOver @dragenter=dragEnter @dragleave=dragLeave\n\t\t:class="{hover}"/>\n',props:{row:Number,col:Number,cont:Object},data:()=>({hover:!1}),computed:{style(){return`grid-area: ${this.row} / ${this.col}`}},methods:{dragOver(t){this.cont.canDrop("grid")&&t.preventDefault()},dragEnter(t){this.hover=!0},dragLeave(t){this.hover=!1},drop(t){this.hover=!1,this.cont.drop({row:this.row,col:this.col,grid:this.$parent.item})}}},i={props:{item:Object,cont:Object},computed:{controlStyle(){return{width:this.item.Width||""}}}};var o={template:'\n<div class="control-group" :style=controlStyle >\n<label v-text="item.Label" v-if="item.Label" />\n\t<div class="input-group">\n\t\t<span v-text="item.Data" class="input" />\n\t</div>\n</div>\n',extends:i};var a={template:'\n<div class="control-group" :style=controlStyle >\n<label v-text="item.Label" v-if="item.Label"/>\n\t<div class="input-group">\n\t\t<span v-text="item.Data" class="input" />\n\t\t<a>\n\t\t\t<i class="ico ico-search" />\n\t\t</a>\n\t</div>\n</div>\n',extends:i};var r={template:'\n<div class="control-group" :style=controlStyle >\n\t<label v-text="item.Label" v-if="item.Label"/>\n\t<div class="input-group">\n\t\t<span v-text="item.Data" class="input text-center"/>\n\t\t<a>\n\t\t\t<i class="ico ico-calendar" />\n\t\t</a>\n\t</div>\n</div>\n',extends:i},l={props:{item:Object,cont:Object},methods:{select(){this.cont.select(this.item)}},computed:{selected(){return this.cont.isActive(this.item)}}};var c={name:"grid",extends:l,template:'\n<div class="fd-elem-grid grid" @click.stop=select :style=gridStyle :class="{selected}">\n\t<template v-for="row in rows">\n\t\t<fd-grid-ph v-for="col in cols" :row=row :col="col" ref=ph\n\t\t\t:key="row + \':\' + col" :cont=cont />\n\t</template>\n\t<fd-grid-item v-for="(itm, ix) in item.Items" :item=itm :key=ix :cont=cont />\n</div>\n',components:{"fd-grid-ph":n,"fd-grid-item":{template:'\n<div class="fd-grid-item" :draggable="true"\n\t@dragstart.stop=dragStart @dragend=dragEnd\n\t:style="style" @click.stop.prevent=select :class="{ selected }">\n\t\t<div class="handle" v-if=hasHandle></div>\n\t\t<component :is="item.Is" :item="item" :cont="cont" />\n</div>\n',props:{item:Object,cont:Object},components:{TextBox:o,Selector:a,DatePicker:r,DataGrid:{template:'\n<div class="fd-datagrid" @dragover=dragOver @drop=drop :style=elemStyle >\n\t<DataGridColumn v-for="(c, ix) in item.Items" :item=c :key=ix :cont=cont />\n</div>\n',props:{item:Object,cont:Object},components:{DataGridColumn:{template:'\n<div class="fd-datagrid-column" @click.stop.prevent="select" :class="{ selected }"\n\t:draggable=true @dragstart.stop=dragStart>\n\t<div v-text="item.Label" class="label" />\n\t<div v-text="item.Data" class="column" />\n</div>\n',extends:l,methods:{dragStart(t){console.dir("drag start column"),this.cont.select(this.item),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify({row:this.row,col:this.col}))}}}},methods:{dragOver(t){t.preventDefault()},drop(t){alert("drop data grid")}},computed:{elemStyle(){return{height:this.item.Height||""}}}},CLabel:{template:'<label v-text="item.Label" />',extends:i},Pager:{template:'<div class="a2-pager">\n\t\t<button>\n\t\t\t<i class="ico ico-chevron-left" />\n\t\t</button>\n\t\t<button>1</button>\n\t\t<button>2</button>\n\t\t<button>3</button>\n\t\t<button>4</button>\n\t\t<button>5</button>\n\t\t<span class="a2-pager-dots">...</span>\n\t\t<button>8</button>\n\t\t<button>\n\t\t\t<i class="ico ico-chevron-right" />\n\t\t</button>\n\t\t<div class="a2-pager-divider" />\n\t\t<span class="a2-pager-title">items: <b>1</b>-<b>20</b> of <b>500</b></span>\n\t</div>',props:{item:Object,cont:Object}},Toolbar:{template:'<div class="toolbar" @dragover=dragOver @drop=drop >\n\t\t<component :is="item.Is" v-for="(item, ix) in item.Items" :item="item" :key="ix" :cont=cont />\n\t</div>',extends:i,components:{Button:{template:'\n<button class="btn btn-tb" @click.stop.prevent="select" :class="{ selected }" :draggable=true\n\t\t@dragstart.stop=dragStart >\n\t<i class="ico" :class=icon />\n\t<span v-if="item.Label" v-text="item.Label" />\t\n</button>\n',extends:l,computed:{icon(){switch(this.item.Command){case"Edit":return"ico-edit";case"New":case"Create":return"ico-add";case"Delete":return"ico-clear";case"Reload":return"ico-reload"}return"ico-menu"}},methods:{dragStart(t){console.dir("drag start button"),this.cont.select(this.item),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",this.item.Is)}}},Aligner:{template:'\n<div class="aligner" @click.stop.prevent="select" :class="{ selected }" :draggable=true\n\t\t@dragstart.stop=dragStart >\n</div>\n',extends:l,methods:{dragStart(t){console.dir("drag start aligner"),this.cont.select(this.item),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",this.item.Is)}}},TextBox:o},methods:{dragOver(t){t.preventDefault()},drop(t){alert("drop toolbar")}}}},computed:{row(){return this.item.row},col(){return this.item.col},rowSpan(){return this.item.rowSpan||1},colSpan(){return this.item.colSpan||1},style(){return`grid-area: ${this.row} / ${this.col} / span ${this.rowSpan} / span ${this.colSpan}`},selected(){return this.cont.isActive(this.item)},hasHandle(){return"DataGrid"==this.item.Is||"Toolbar"===this.item.Is}},methods:{select(){this.cont.select(this.item)},dragStart(t){console.dir("drag start"),this.cont.select(this.item),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify({row:this.row,col:this.col}))},dragEnd(){console.dir("drag end")}}}},props:{item:Object,cont:Object},computed:{cols(){return this.item.Columns?this.item.Columns.split(" ").map(((t,e)=>e+1)):0},rows(){return this.item.Rows?this.item.Rows.split(" ").map(((t,e)=>e+1)):0},gridStyle(){return{gridTemplateColumns:this.item.Columns||"",gridTemplateRows:this.item.Rows||"",height:this.item.Height||""}}}},d={template:'<div class="line" @click.stop.prevent=select :class="{selected}"><hr></div>',extends:l};var m={template:'<div class="modal-footer" @dragover=dragOver @drop=drop >\n\t\t<component :is="itm.Is" v-for="(itm, ix) in elems"\n\t\t\t:item="itm" :key="ix" :cont=cont />\n\t</div>',extends:i,props:{elems:Array},components:{Button:{template:'\n<button @click.stop.prevent="select" class="btn a2-inline" :class="{ selected, \'btn-primary\': item.Primary }" :draggable=true\n\t@dragstart.stop=dragStart v-text="item.Label">\n</button>\n',extends:l,computed:{},methods:{dragStart(t){console.dir("drag start button"),this.cont.select(this.item),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",this.item.Is)}}}},methods:{dragOver(t){t.preventDefault()},drop(t){alert("drop toolbar")}}};Vue.component("Grid",c),Vue.component("fd-container",{template:'\n<div class="fd-container" @keyup.self=keyUp tabindex=0 >\n\t<fd-toolbar></fd-toolbar>\n\t<fd-taskpad :item=selectedItem :fields=fields :cont=cont :components=components />\n\t<div class="fd-main" @click.stop.stop=clickBody>\n\t\t<div class=fd-body  @click.stop.stop=clickBody :class="bodyClass" :style="bodyStyle">\n\t\t\t<div v-if="isDialog" class="modal-header">\n\t\t\t\t<span class="modal-title" v-text="form.Label"/>\n\t\t\t\t<button tabindex="-1" class="btnclose">✕</button>\n\t\t\t</div>\n\t\t\t<div class="fd-content">\n\t\t\t\t<component v-for="(itm, ix) in form.Items" :key="ix" :is="itm.Is"\n\t\t\t\t\t:item="itm" :cont=cont />\n\t\t\t</div>\n\t\t\t<dlg-buttons v-if="isDialog" :elems="form.Buttons" :cont=cont />\n\t\t</div>\n\t\t<div class="fd-page-taskpad">\n\t\t</div>\n\t</div>\n</div>\n',components:{"fd-toolbar":s,"fd-taskpad":e,"dlg-buttons":m,HLine:d},props:{form:Object,fields:Array,components:Array},data:()=>({selectedItem:null}),computed:{cont(){return{select:this.$selectItem,drop:this.$dropItem,isActive:t=>t===this.selectedItem,canDrop:this.$canDrop}},bodyClass(){return this.form.Is.toLowerCase()},bodyStyle(){let t={};return this.isDialog&&(t.width=this.form.Width),t},isDialog(){return"Dialog"===this.form.Is}},methods:{clickBody(){this.selectedItem=this.form},keyUp(t){if(console.dir(t.which),46===t.which)this.deleteItem()},deleteItem(){if(!this.selectedItem)return;let t=this.findGridByItem(this.selectedItem);if(!t||"Grid"!==t.Is)return;let e=t.Items.indexOf(this.selectedItem);e<0||(t.Items.splice(e,1),this.selectedItem=this.form)},findGridByItem(t){return function t(e,s){if(!e||!e.Items)return null;for(let n=0;n<e.Items.length;n++){let i=e.Items[n];if(i===s)return e;if("Grid"!==i.Is)continue;let o=t(i,s);if(o)return o}return null}(this.form,t)},$selectItem(t){this.selectedItem=t},$canDrop(t){let e=this.selectedItem;return!!e&&(console.dir(e.Is),"grid"!==t||"Button"!==e.Is&&"DataGridColumn"!==e.Is)},$dropItem(t){if(!this.selectedItem)return;if(console.dir(this.selectedItem),console.dir(t),!this.selectedItem.row&&!this.selectedItem.col){let e=Object.assign({},this.selectedItem);return e.Items=[],e.row=t.row,e.col=t.col,t.grid.Items.push(e),void(this.selectedItem=e)}let e=this.findGridByItem(this.selectedItem);if(e&&"Grid"===e.Is&&e!==t.grid){let s=e.Items.indexOf(this.selectedItem);e.Items.splice(s,1),t.grid.Items.push(this.selectedItem)}this.selectedItem.row=t.row,this.selectedItem.col=t.col}},mounted(){this.selectedItem=this.form}})}));
//# sourceMappingURL=formdesigner.min.js.map
